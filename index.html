<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/donmccurdy/aframe-physics-system/v4.0.1/dist/aframe-physics-system.min.js"></script>
  </head>
  <body>
    
    <script>
        AFRAME.registerComponent('darker-over-time', {
          init: function () {
            const el = this.el;
            const boxColor = this.data.boxColor;
            let intensity = 1; // Initial intensity (1 is normal, 0 is completely dark)
            const intervalMs = 1000; // Change color every 3 seconds
            const totalTimeMs = 10000; 
  

            const hex2rgb = (hex) => {
                const r = parseInt(hex.slice(1, 3), 16);
                const g = parseInt(hex.slice(3, 5), 16);
                const b = parseInt(hex.slice(5, 7), 16);
    
                // return {r, g, b} 
                return { r, g, b };
            }
            
            // Function to darken the material color
            function darkenMaterial() {
                intensity -= 0.1; // Decrease intensity (you can adjust the rate)
                if (intensity < 0) {
                    intensity = 0; // Ensure the intensity doesn't go below 0
                }  
              
                const rgbColor = hex2rgb(boxColor); // Replace "#FFA500" with the hex color you want to convert
              // Set the new color with adjusted intensity
                const color = `rgb(${Math.round(rgbColor.r * intensity)}, ${Math.round(rgbColor.g * intensity)}, ${Math.round(rgbColor.b * intensity)})`;
                    el.setAttribute('material', 'color', color);
            }
            function lightenMaterial() {
                intensity += 0.1; // Decrease intensity (you can adjust the rate)
                if (intensity > 0.8) {
                    intensity = 0.8; // Ensure the intensity doesn't go below 0
                }

                const rgbColor = hex2rgb(boxColor); // Replace "#FFA500" with the hex color you want to convert

                // Set the new color with adjusted intensity
                const color = `rgb(${Math.round(rgbColor.r * intensity)}, ${Math.round(rgbColor.g * intensity)}, ${Math.round(rgbColor.b * intensity)})`;
                    el.setAttribute('material', 'color', color);
            }
            
            const darkeningInterval = setInterval(darkenMaterial, intervalMs);

            setTimeout(() => {
            clearInterval(darkeningInterval);

            // Start the lighter-over-time script
            const lighterInterval = setInterval(lightenMaterial, intervalMs);

            // Stop the lightening transition after totalTimeMs
            setTimeout(() => {
              clearInterval(lighterInterval);
            }, totalTimeMs);
          }, totalTimeMs);
        },
        });
      </script>

      <script>
        AFRAME.registerComponent('limit-my-distance', {
    
          init: function() {
            this.zero = new THREE.Vector3(0, 0, 0);
          },
          tick: function() {
            const camera = document.querySelector('#camera');
            // const currentPosition = camera.getAttribute('position');
            // console.log(currentPosition);
            let currentPosition = camera.getAttribute('position');

            // In case of collision with right wall
            if (currentPosition.x >= 4.5) {
              currentPosition = camera.getAttribute('position');
              this.el.object3D.position.set((currentPosition.x - 0.5), currentPosition.y, (currentPosition.z));
            }
            // In case of collision with left wall
            if (currentPosition.x <= -4) {
              currentPosition = camera.getAttribute('position');
              this.el.object3D.position.set((currentPosition.x + 0.5), currentPosition.y, (currentPosition.z));
            }
            // In case of collision with front wall
            if (currentPosition.z <= -6.5) {
              currentPosition = camera.getAttribute('position');
              this.el.object3D.position.set(currentPosition.x, currentPosition.y, (currentPosition.z + 0.5));
            }
            // In case of collision with back wall
            if (currentPosition.z >= 0) {
              currentPosition = camera.getAttribute('position');
              this.el.object3D.position.set(currentPosition.x, currentPosition.y, (currentPosition.z - 0.5));
            }
          }
        });
      </script>
    
    <a-scene>
      <!-- Camera inside the room -->
      <!-- <a-camera id="camera" position="0 2 -1.5" look-controls kinematic-body></a-camera> -->
      <a-camera id="camera" position="0 2 -1.5" limit-my-distance></a-camera>
    
      <!-- Room components -->
        <a-box class="wall" position="0 0 -3.7" width="15" height="2.1" depth="15" color="#afb2b3" darker-over-time="boxColor: #afb2b3;" static-body></a-box> <!-- Floor -->
        <a-box class="wall" position="0.25 4.2 -3.5" width="10.5" height="1" depth="10" color="#ecf0f1" darker-over-time="boxColor: #ecf0f1;" static-body></a-box> <!-- Ceiling -->
        <a-box class="wall" position="0.3 2.5 -8" width="10.4" height="2.5" depth="1" color="#e74c3c" darker-over-time="boxColor: #e74c3c;" static-body ></a-box> <!-- Front Wall -->
        <a-box class="wall" position="0 2.5 1" width="10" height="2.5" depth="1" color="#e74c3c" darker-over-time="boxColor: #e74c3c;" static-body></a-box> <!-- Back Wall -->
        <a-box class="wall" position="-4.5 2.5 -4" width="1" height="2.5" depth="9" color="#f1c40f" darker-over-time="boxColor: #f1c40f;" static-body></a-box> <!-- Left Wall -->
        <a-box class="wall" position="5 2.5 -3" width="1" height="2.5" depth="9" color="#2ecc71" darker-over-time="boxColor: #2ecc71;" static-body></a-box> <!-- Right Wall -->
        
        <!-- Furniture -->

        <!-- Door -->
        <a-box position="-2 2.35 -7.54" width="1.15" height="2.2" depth="0.1" color="#4a3423"  darker-over-time="boxColor: #4a3423;"></a-box> <!-- Door frame -->
        <a-box position="-2 2.3 -7.54" width="1" height="2.1" depth="0.15" color="#7d5c42"  darker-over-time="boxColor: #7d5c42;"></a-box> <!-- Door Base -->
        <a-sphere position="-1.7 2.2 -7.54" radius="0.1" color="#b0aaa5"  darker-over-time="boxColor: #b0aaa5;"></a-sphere> <!-- Door handle -->

        <!-- Painting -->
        <a-box position="1 2.55 0.5" width="3" height="1.2" depth="0.2" color="#7d5c42" darker-over-time="boxColor: #7d5c42;"></a-box> <!-- Painting frame -->
        <a-box position="1 2.55 0.5" width="2.8" height="1" depth="0.25" color="#ecf0f1" material="src: url(./images/Painting.jpg);" darker-over-time="boxColor: #ecf0f1;"></a-box> <!-- Painting base  -->

        <!-- Table -->
        <a-box position="4.4 1.8 -5.2" width="0.2" height="0.5" depth="0.8" color="#d35400" darker-over-time="boxColor: #d35400;"></a-box> <!-- Table Base -->
        <a-box position="4.4 2.1 -5.2" width="0.2" height="0.1" depth="0.8" color="#e67e22" darker-over-time="boxColor: #e67e22;"></a-box> <!-- Table Top -->
        <a-cylinder position="4.4 1.4 -5.5" radius="0.1" height="0.3" color="#95a5a6" darker-over-time="boxColor: #95a5a6;"></a-cylinder> <!-- Table Leg -->
        <a-cylinder position="4.4 1.4 -5" radius="0.1" height="0.3" color="#95a5a6" darker-over-time="boxColor: #95a5a6;"></a-cylinder> <!-- Table Leg -->
        
        <!-- Lamp on the Table -->
        <a-cylinder position="4.4 2.2 -5.2" radius="0.1" height="0.1" color="#bdc3c7" darker-over-time="boxColor: #bdc3c7;"></a-cylinder> <!-- Lamp Base -->
        <a-cylinder position="4.4 2.3 -5.2" radius="0.05" height="0.3" color="#ecf0f1" darker-over-time="boxColor: #ecf0f1;"></a-cylinder> <!-- Lamp Stand -->
        <a-sphere position="4.4 2.5 -5.2" radius="0.1" color="#f1c40f" darker-over-time="boxColor: #f1c40f;"></a-sphere> <!-- Lamp Shade -->
         
        <!-- Bed -->
        <a-box position="-3.2 1.45 -1.65" width="1.82" height="0.42" depth="1.8" color="#4367c4" darker-over-time="boxColor: #4367c4;"></a-box> <!-- Bed Blanket -->
        <a-box position="-3.2 1.65 0.2" width="1.1" height="0.2" depth="0.5" color="#5575c9" darker-over-time="boxColor: #4367c4;"></a-box> <!-- Bed Pillow -->
        <a-box position="-3.2 1.45 -1" width="1.8" height="0.4" depth="3" color="#bdc3c7" darker-over-time="boxColor: #bdc3c7;"></a-box> <!-- Bed Matrass -->
        <a-cylinder position="-2.6 1.2 0.3" radius="0.2" height="0.2" color="#95a5a6" darker-over-time="boxColor: #95a5a6;"></a-cylinder> <!-- Bed Leg -->
        <a-cylinder position="-2.6 1 -2" radius="0.2" height="0.5" color="#95a5a6" darker-over-time="boxColor: #95a5a6;"></a-cylinder> <!-- Bed Leg -->
        
        <!-- <a-light type="directional" position="-3 5 0" intensity="0.5" target="#bed"></a-light> -->
    </a-scene>

  </body>
</html>
